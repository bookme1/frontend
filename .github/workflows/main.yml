# .github/workflows/deploy-frontend.yml

on:
    push:
        branches:
            - main

name: ðŸš€ Deploy Frontend on Push

jobs:
    frontend-deploy:
        name: ðŸŽ‰ Deploy Frontend
        runs-on: ubuntu-latest
        steps:
            - name: ðŸšš Get latest code
              uses: actions/checkout@v4

            - name: Use Node.js 20
              uses: actions/setup-node@v2
              with:
                  node-version: '20'

            - name: ðŸ”¨ Build Frontend Project
              run: |
                  npm install
                  npm run build

            # Frontend deploy in /bookme/client
            - name: ðŸ“‚ Deploy Frontend to /bookme/client
              uses: SamKirkland/FTP-Deploy-Action@v4.3.5
              with:
                  server: ${{ secrets.FTP_SERVER }}
                  username: ${{ secrets.FTP_USERNAME }}
                  password: ${{ secrets.FTP_PASSWORD }}
                  local-dir: ./out
                  server-dir: /bookme/client

            # Ð¡opy frontend code from /bookme/client into /public_html
            - name: ðŸ”„ Copy Frontend to /public_html
              run: |
                  sudo apt-get install lftp -y
                  lftp -e "mirror -R /bookme/client /public_html; bye" -u ${{ secrets.FTP_USERNAME }},${{ secrets.FTP_PASSWORD }} ${{ secrets.FTP_SERVER }}
